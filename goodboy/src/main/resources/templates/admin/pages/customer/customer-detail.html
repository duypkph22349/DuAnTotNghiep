<!DOCTYPE html>
<html lang="en">
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<html lang="en" xmlns:th="http://www.springframework.org/schema/data/jaxb">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
<head>
    <meta charset="UTF-8">
    <title>Customer</title>
</head>
<body>
<h1 style="text-align: center">UPDATE CUSTOMER</h1>
<form th:object="${detail}" th:action="@{/admin/customer/add}" action="#" method="post">
    <input type="hidden" th:field="*{id}">

    <div>
        <label>Code:</label>
        <input type="text" th:name="code" class="form-control" th:value="${detail.code}">
    </div>
    <div style="clear: both; display: block; height: 10px"  ></div>
    <div>
        <label>Name:</label>
        <input type="text" th:name="name"  class="form-control" th:value="${detail.name}">
    </div>
    <div style="clear: both; display: block; height: 10px"></div>
    <div>
        <label>Gender:</label>
        <input type="radio" th:name="gender"  th:value="false" th:text="Male" th:checked="${detail.gender==false}">
        <input type="radio" th:name="gender"  th:value="true" th:text="Female" th:checked="${detail.gender==true}">
    </div>
    <div style="clear: both; display: block; height: 10px"></div>
    <div>
        <label>Birth Date:</label>
        <input type="date" th:name="birth_date"  class="form-control" th:value="${detail.birth_date}">
    </div>
    <div style="clear: both; display: block; height: 10px"></div>
    <div>
        <label>Phone:</label>
        <input type="text" th:name="phone"  class="form-control" th:value="${detail.phone}">
    </div>
    <div style="clear: both; display: block; height: 10px"></div>
    <div>
        <label>Address:</label>
<!--        <input type="text" th:name="address" class="form-control" th:value="${detail.address}">-->
        <select th:name="address" id="province">
            <option th:value="${detail.address}" th:each="x:${detail}"></option>
        </select>
    </div>
    <div style="clear: both; display: block; height: 10px"></div><div>
    <label>City:</label>
    <input type="text" th:name="city" class="form-control" th:value="${detail.city}">
</div>
    <div style="clear: both; display: block; height: 10px"></div><div>
    <label>Country:</label>
    <input type="text" th:name="country" class="form-control" th:value="${detail.country}">
</div>
    <div style="clear: both; display: block; height: 10px"></div>
    <div>
        <select th:name="status">
            <option th:value="0" th:selected="${detail.status==0}">Active</option>
            <option th:value="1" th:selected="${detail.status==1}">No longer active</option>
        </select>
    </div>
    <div style="clear: both; display: block; height: 10px"></div>
    <input type="submit" class="btn btn-success" value="Update" />
</form>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.26.1/axios.min.js"
        integrity="sha512-bPh3uwgU5qEMipS/VOmRqynnMXGGSRv+72H/N260MQeXZIK4PG48401Bsby9Nq5P5fz7hy5UGNmC/W1Z51h2GQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
    // 1. what is API
    // 2. How do I call API
    // 3. Explain code
    const host = "https://provinces.open-api.vn/api/";
    var callAPI = (api) => {
        return axios.get(api)
            .then((response) => {
                renderData(response.data, "province");
            });
    }
    callAPI('https://provinces.open-api.vn/api/?depth=1');
    var callApiDistrict = (api) => {
        return axios.get(api)
            .then((response) => {
                renderData(response.data.districts, "district");
            });
    }
    var callApiWard = (api) => {
        return axios.get(api)
            .then((response) => {
                renderData(response.data.wards, "ward");
            });
    }

    var renderData = (array, select) => {
        let row = ' <option disable value="">ch·ªçn</option>';
        array.forEach(element => {
            row += `<option value="${element.code}">${element.name}</option>`
        });
        document.querySelector("#" + select).innerHTML = row
    }

    $("#province").change(() => {
        callApiDistrict(host + "p/" + $("#province").val() + "?depth=2");
        printResult();
    });
    $("#district").change(() => {
        callApiWard(host + "d/" + $("#district").val() + "?depth=2");
        printResult();
    });
    $("#ward").change(() => {
        printResult();
    })

    var printResult = () => {
        if ($("#district").val() != "" && $("#province").val() != "" &&
            $("#ward").val() != "") {
            let result = $("#province option:selected").text() +
                " | " + $("#district option:selected").text() + " | " +
                $("#ward option:selected").text();
            $("#result").text(result)
        }

    }
</script>
</body>
</html>