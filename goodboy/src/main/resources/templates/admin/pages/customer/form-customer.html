<!DOCTYPE html>
<html lang="en">
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<html lang="en" xmlns:th="http://www.springframework.org/schema/data/jaxb">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<body class="container">
<div class="container col-8">
<!--    <h1 style="text-align: center">ADD CUSTOMER</h1>-->
<!--    <form th:object="${customer}" th:action="@{/admin/customer/add}" action="#" method="post">-->

<!--        <div>-->
<!--            <label>Code:</label>-->
<!--            <input type="text" th:name="code" class="form-control">-->
<!--        </div>-->
<!--        <div style="clear: both; display: block; height: 10px"></div>-->
<!--        <div>-->
<!--            <label>Name:</label>-->
<!--            <input type="text" th:name="name" class="form-control">-->
<!--        </div>-->
<!--        <div style="clear: both; display: block; height: 10px"></div>-->
<!--        <div>-->
<!--            <label>Gender:</label>-->
<!--            <input type="radio" th:name="gender" th:value="false" th:text="Male" checked>-->
<!--            <input type="radio" th:name="gender" th:value="true" th:text="Female">-->
<!--        </div>-->
<!--        <div style="clear: both; display: block; height: 10px"></div>-->
<!--        <div>-->
<!--            <label>Birth Date:</label>-->
<!--            <input type="date" th:name="birth_date" class="form-control">-->
<!--        </div>-->
<!--        <div style="clear: both; display: block; height: 10px"></div>-->
<!--        <div>-->
<!--            <label>Phone:</label>-->
<!--            <input type="text" th:name="phone" class="form-control">-->
<!--        </div>-->



<!--           <div style="clear: both; display: block; height: 10px"></div>-->
<!--        <div>-->
<!--            <label>Address:</label>-->
<!--            &lt;!&ndash;            <input type="text" th:name="address" class="form-control">&ndash;&gt;-->
<!--            <select th:name="address" id="province">-->
<!--                <option ></option>-->
<!--            </select>-->
<!--        </div>-->
<!--        <div style="clear: both; display: block; height: 10px"></div><div>-->
<!--        <label>City:</label>-->
<!--        &lt;!&ndash;            <input type="text" th:name="city" class="form-control">&ndash;&gt;-->
<!--        <select th:name="city" id="district">-->
<!--            <option >chọn quận</option>-->
<!--        </select>-->
<!--    </div>-->
<!--        <div style="clear: both; display: block; height: 10px"></div><div>-->
<!--        <label>Country:</label>-->
<!--        &lt;!&ndash;            <input type="text" th:name="country" class="form-control">&ndash;&gt;-->
<!--        <select th:name="country" id="ward">-->
<!--            <option >chọn quận</option>-->
<!--        </select>-->
<!--    </div>-->



<!--        <div style="clear: both; display: block; height: 10px"></div>-->
<!--        <div>-->
<!--            <select th:name="status">-->
<!--                <option th:value="0">Active</option>-->
<!--                <option th:value="1">No longer active</option>-->
<!--            </select>-->
<!--        </div>-->
<!--        <div style="clear: both; display: block; height: 10px"></div>-->
<!--        <input type="submit" class="btn btn-success" value="ADD"/>-->
<!--    </form>-->
    <a href="/admin/customer/view-add">New</a>
    <h1 style="text-align: center">LIST CUSTOMER</h1>
    <table class="table table-active">
        <tr>
            <th>#</th>
            <th>Code</th>
            <th>Name</th>
            <th>Gender</th>
            <th>Birth_Date</th>
            <th>Phone</th>
            <th>Address</th>
            <th>City</th>
            <th>Country</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
        <tr th:each="customer, i :${list}">
            <td th:text="${i.index+1}"></td>
            <td th:text="${customer.code}"></td>
            <td th:text="${customer.name}"></td>
            <td th:text="${customer.gender}==false?'Male':'Female'"></td>
            <td th:text="${customer.birth_date}"></td>
            <td th:text="${customer.phone}"></td>
            <td th:text="${customer.address}"></td>
            <td th:text="${customer.city}"></td>
            <td th:text="${customer.country}"></td>
            <td th:text="${customer.status}==0?'Active':'No longer active'"></td>
            <td>
                <a th:href="@{'/admin/customer/detail/' + ${customer.id}}" class="btn btn-primary">Detail</a>
                <a th:href="@{'/admin/customer/delete/' + ${customer.id}}" class="btn btn-danger">Delete</a>
            </td>
        </tr>
    </table>
    <ul class="pagination">
        <th:block th:each="i: ${#numbers.sequence(1, totalPage)}">
            <li class="page-item">
                <a class="page-link" th:href="@{'/admin/customer/get-all?pageNum=' + ${i}}" th:text=${i}></a>
            </li>
        </th:block>
    </ul>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.26.1/axios.min.js"
        integrity="sha512-bPh3uwgU5qEMipS/VOmRqynnMXGGSRv+72H/N260MQeXZIK4PG48401Bsby9Nq5P5fz7hy5UGNmC/W1Z51h2GQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<!--<script>-->
<!--    // 1. what is API-->
<!--    // 2. How do I call API-->
<!--    // 3. Explain code-->


<!--    // var renderData = (array, select) => {-->
<!--    //     let row = ' <option disable value="">chọn</option>';-->
<!--    //     array.forEach(element => {-->
<!--    //         row += `<option value="${element.code}">${element.name}</option>`-->
<!--    //     });-->
<!--    //     document.querySelector("#" + select).innerHTML = row-->
<!--    // }-->

<!--    $("#province").change(() => {-->
<!--        callApiDistrict(host + "p/" + $("#province").val() + "?depth=2");-->
<!--        printResult();-->
<!--    });-->
<!--    $("#district").change(() => {-->
<!--        callApiWard(host + "d/" + $("#district").val() + "?depth=2");-->
<!--        printResult();-->
<!--    });-->
<!--    $("#ward").change(() => {-->
<!--        printResult();-->
<!--    })-->

<!--    var printResult = () => {-->
<!--        if ($("#district").val() != "" && $("#province").val() != "" &&-->
<!--            $("#ward").val() != "") {-->
<!--            let result = $("#province option:selected").text() +-->
<!--                " | " + $("#district option:selected").text() + " | " +-->
<!--                $("#ward option:selected").text();-->
<!--            $("#result").text(result)-->
<!--        }-->

<!--    }-->
<!--    var renderData = (array, select) => {-->
<!--        let row = ' <option disable value="">chọn</option>';-->
<!--        array.forEach(element => {-->
<!--            row += `<option value="${element.name}" data-name="${element.code}">${element.name}</option>`-->
<!--        });-->
<!--        document.querySelector("#" + select).innerHTML = row-->
<!--    }-->
<!--    var getCodeToName = (selectId, code) => {-->
<!--        var select = document.getElementById(selectId);-->
<!--        var options = select.getElementsByTagName("option");-->
<!--        for (var i = 0; i < options.length; i++) {-->
<!--            if (options[i].value === code) {-->
<!--                return options[i].getAttribute("data-name");-->
<!--            }-->
<!--        }-->
<!--        return "";-->
<!--    }-->
<!--    var selectedName = getCodeToName("province", $("#province").val());-->
<!--    console.log(selectedName); // In tên tương ứng của tỉnh thành được chọn-->
<!--</script>-->
<script>
    // Modify the renderData function to use the data-name attribute for value and text
    const host = "https://provinces.open-api.vn/api/";
    var callAPI = (api) => {
        return axios.get(api)
            .then((response) => {
                renderData(response.data, "province");
            });
    }
    callAPI('https://provinces.open-api.vn/api/?depth=1');
    var callApiDistrict = (api) => {
        return axios.get(api)
            .then((response) => {
                renderData(response.data.districts, "district");
            });
    }
    var callApiWard = (api) => {
        return axios.get(api)
            .then((response) => {
                renderData(response.data.wards, "ward");
            });
    }
    var renderData = (array, select) => {
        let row = ' <option disable value="">chọn</option>';
        array.forEach(element => {
            row += `<option value="${element.code}" data-name="${element.code}">${element.name}</option>`
        });
        document.querySelector("#" + select).innerHTML = row;
    };

    // Modify the getCodeToName function to filter options based on data-name attribute
    var getCodeToName = (selectId, code) => {
        var select = document.getElementById(selectId);
        var options = select.getElementsByTagName("option");
        for (var i = 0; i < options.length; i++) {
            if (options[i].getAttribute("data-name") === code) {
                return options[i].value;
            }
        }
        return "";
    };

    $("#province").change(() => {
        callApiDistrict(host + "p/" + $("#province").val() + "?depth=2");
        printResult();
    });

    $("#district").change(() => {
        callApiWard(host + "d/" + $("#district").val() + "?depth=2");
        printResult();
    });

    $("#ward").change(() => {
        printResult();
    });

    var printResult = () => {
        if ($("#district").val() !== "" && $("#province").val() !== "" &&
            $("#ward").val() !== "") {
            let provinceName = getCodeToName("province", $("#province").val());
            let districtName = getCodeToName("district", $("#district").val());
            let wardName = getCodeToName("ward", $("#ward").val());

            let result = provinceName + " | " + districtName + " | " + wardName;
            $("#result").text(result);
        }
    };
</script>
</body>
</html>